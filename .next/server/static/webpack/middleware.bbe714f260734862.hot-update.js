"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("middleware",{

/***/ "(middleware)/./middleware.ts":
/*!***********************!*\
  !*** ./middleware.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   middleware: () => (/* binding */ middleware)\n/* harmony export */ });\n/* harmony import */ var next_server__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/server */ \"(middleware)/./node_modules/next/dist/esm/api/server.js\");\n/* harmony import */ var _lib_auth__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/auth */ \"(middleware)/./lib/auth.ts\");\n// middleware.ts\n\n\n/** Public API (auth talab qilinmaydi) */ const PUBLIC_API_PREFIXES = [\n    \"/api/miniapp\",\n    \"/api/auth\"\n];\n/** UI va (public bo‘lmagan) API’lar uchun himoya */ const PROTECTED_PAGE_PREFIXES = [\n    \"/patients\",\n    \"/appointments\",\n    \"/statistics\",\n    \"/users\",\n    \"/doctors\",\n    \"/services\",\n    \"/invoices\"\n];\nfunction middleware(req) {\n    const { pathname, search } = req.nextUrl;\n    // 0) Static/public fayllarni chetlab o‘tamiz\n    if (pathname.startsWith(\"/_next\") || pathname.startsWith(\"/favicon\") || pathname.startsWith(\"/icons\") || pathname.startsWith(\"/img\") || pathname === \"/\") {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    // 1) CORS preflight — HAR DOIM o‘tkazamiz (aks holda 307/CORS xatosi bo‘ladi)\n    if (req.method === \"OPTIONS\") {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    // 2) Public API’lar — middleware’dan o‘tkazib yuboramiz\n    if (PUBLIC_API_PREFIXES.some((p)=>pathname.startsWith(p))) {\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n    }\n    const isLoginPage = pathname === \"/login\";\n    const authed = (0,_lib_auth__WEBPACK_IMPORTED_MODULE_1__.hasAuthCookie)(req.headers.get(\"cookie\"));\n    // 3) Login sahifasiga kelsa va allaqachon login bo‘lsa -> /statistics\n    if (isLoginPage && authed) {\n        const url = req.nextUrl.clone();\n        url.pathname = \"/statistics\";\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(url);\n    }\n    // 4) Himoyalangan UI sahifalar\n    const needsAuthPage = PROTECTED_PAGE_PREFIXES.some((p)=>pathname.startsWith(p));\n    // 5) Himoyalangan API: /api/** lekin PUBLIC_API_PREFIXES tarkibiga kirmaganlari\n    const isApi = pathname.startsWith(\"/api\");\n    const isProtectedApi = isApi && !PUBLIC_API_PREFIXES.some((p)=>pathname.startsWith(p));\n    if ((needsAuthPage || isProtectedApi) && !authed) {\n        const url = req.nextUrl.clone();\n        url.pathname = \"/login\";\n        url.searchParams.set(\"next\", pathname + (search || \"\"));\n        return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.redirect(url);\n    }\n    return next_server__WEBPACK_IMPORTED_MODULE_0__.NextResponse.next();\n}\nconst config = {\n    matcher: [\n        \"/((?!_next/static|_next/image|favicon.ico|icons/|img/).*)\"\n    ]\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKG1pZGRsZXdhcmUpLy4vbWlkZGxld2FyZS50cyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUEsZ0JBQWdCO0FBQ3dDO0FBQ2I7QUFFM0MsdUNBQXVDLEdBQ3ZDLE1BQU1FLHNCQUFzQjtJQUFDO0lBQWdCO0NBQVk7QUFFekQsa0RBQWtELEdBQ2xELE1BQU1DLDBCQUEwQjtJQUM5QjtJQUNBO0lBQ0E7SUFDQTtJQUNBO0lBQ0E7SUFDQTtDQUNEO0FBRU0sU0FBU0MsV0FBV0MsR0FBZ0I7SUFDekMsTUFBTSxFQUFFQyxRQUFRLEVBQUVDLE1BQU0sRUFBRSxHQUFHRixJQUFJRyxPQUFPO0lBRXhDLDZDQUE2QztJQUM3QyxJQUNFRixTQUFTRyxVQUFVLENBQUMsYUFDcEJILFNBQVNHLFVBQVUsQ0FBQyxlQUNwQkgsU0FBU0csVUFBVSxDQUFDLGFBQ3BCSCxTQUFTRyxVQUFVLENBQUMsV0FDcEJILGFBQWEsS0FDYjtRQUNBLE9BQU9OLHFEQUFZQSxDQUFDVSxJQUFJO0lBQzFCO0lBRUEsOEVBQThFO0lBQzlFLElBQUlMLElBQUlNLE1BQU0sS0FBSyxXQUFXO1FBQzVCLE9BQU9YLHFEQUFZQSxDQUFDVSxJQUFJO0lBQzFCO0lBRUEsd0RBQXdEO0lBQ3hELElBQUlSLG9CQUFvQlUsSUFBSSxDQUFDLENBQUNDLElBQU1QLFNBQVNHLFVBQVUsQ0FBQ0ksS0FBSztRQUMzRCxPQUFPYixxREFBWUEsQ0FBQ1UsSUFBSTtJQUMxQjtJQUVBLE1BQU1JLGNBQWNSLGFBQWE7SUFDakMsTUFBTVMsU0FBU2Qsd0RBQWFBLENBQUNJLElBQUlXLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDO0lBRTdDLHNFQUFzRTtJQUN0RSxJQUFJSCxlQUFlQyxRQUFRO1FBQ3pCLE1BQU1HLE1BQU1iLElBQUlHLE9BQU8sQ0FBQ1csS0FBSztRQUM3QkQsSUFBSVosUUFBUSxHQUFHO1FBQ2YsT0FBT04scURBQVlBLENBQUNvQixRQUFRLENBQUNGO0lBQy9CO0lBRUEsK0JBQStCO0lBQy9CLE1BQU1HLGdCQUFnQmxCLHdCQUF3QlMsSUFBSSxDQUFDLENBQUNDLElBQ2xEUCxTQUFTRyxVQUFVLENBQUNJO0lBR3RCLGdGQUFnRjtJQUNoRixNQUFNUyxRQUFRaEIsU0FBU0csVUFBVSxDQUFDO0lBQ2xDLE1BQU1jLGlCQUNKRCxTQUFTLENBQUNwQixvQkFBb0JVLElBQUksQ0FBQyxDQUFDQyxJQUFNUCxTQUFTRyxVQUFVLENBQUNJO0lBRWhFLElBQUksQ0FBQ1EsaUJBQWlCRSxjQUFhLEtBQU0sQ0FBQ1IsUUFBUTtRQUNoRCxNQUFNRyxNQUFNYixJQUFJRyxPQUFPLENBQUNXLEtBQUs7UUFDN0JELElBQUlaLFFBQVEsR0FBRztRQUNmWSxJQUFJTSxZQUFZLENBQUNDLEdBQUcsQ0FBQyxRQUFRbkIsV0FBWUMsQ0FBQUEsVUFBVSxFQUFDO1FBQ3BELE9BQU9QLHFEQUFZQSxDQUFDb0IsUUFBUSxDQUFDRjtJQUMvQjtJQUVBLE9BQU9sQixxREFBWUEsQ0FBQ1UsSUFBSTtBQUMxQjtBQUVPLE1BQU1nQixTQUFTO0lBQ3BCQyxTQUFTO1FBQUM7S0FBNEQ7QUFDeEUsRUFBRSIsInNvdXJjZXMiOlsiL1VzZXJzL3NoYWh6b2RudW1hbmpvbm92L0Rlc2t0b3AvZWNsaW5pYy1zYWFzL21pZGRsZXdhcmUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gbWlkZGxld2FyZS50c1xuaW1wb3J0IHsgTmV4dFJlcXVlc3QsIE5leHRSZXNwb25zZSB9IGZyb20gXCJuZXh0L3NlcnZlclwiO1xuaW1wb3J0IHsgaGFzQXV0aENvb2tpZSB9IGZyb20gXCJAL2xpYi9hdXRoXCI7XG5cbi8qKiBQdWJsaWMgQVBJIChhdXRoIHRhbGFiIHFpbGlubWF5ZGkpICovXG5jb25zdCBQVUJMSUNfQVBJX1BSRUZJWEVTID0gW1wiL2FwaS9taW5pYXBwXCIsIFwiL2FwaS9hdXRoXCJdO1xuXG4vKiogVUkgdmEgKHB1YmxpYyBib+KAmGxtYWdhbikgQVBJ4oCZbGFyIHVjaHVuIGhpbW95YSAqL1xuY29uc3QgUFJPVEVDVEVEX1BBR0VfUFJFRklYRVMgPSBbXG4gIFwiL3BhdGllbnRzXCIsXG4gIFwiL2FwcG9pbnRtZW50c1wiLFxuICBcIi9zdGF0aXN0aWNzXCIsXG4gIFwiL3VzZXJzXCIsXG4gIFwiL2RvY3RvcnNcIixcbiAgXCIvc2VydmljZXNcIixcbiAgXCIvaW52b2ljZXNcIixcbl07XG5cbmV4cG9ydCBmdW5jdGlvbiBtaWRkbGV3YXJlKHJlcTogTmV4dFJlcXVlc3QpIHtcbiAgY29uc3QgeyBwYXRobmFtZSwgc2VhcmNoIH0gPSByZXEubmV4dFVybDtcblxuICAvLyAwKSBTdGF0aWMvcHVibGljIGZheWxsYXJuaSBjaGV0bGFiIG/igJh0YW1pelxuICBpZiAoXG4gICAgcGF0aG5hbWUuc3RhcnRzV2l0aChcIi9fbmV4dFwiKSB8fFxuICAgIHBhdGhuYW1lLnN0YXJ0c1dpdGgoXCIvZmF2aWNvblwiKSB8fFxuICAgIHBhdGhuYW1lLnN0YXJ0c1dpdGgoXCIvaWNvbnNcIikgfHxcbiAgICBwYXRobmFtZS5zdGFydHNXaXRoKFwiL2ltZ1wiKSB8fFxuICAgIHBhdGhuYW1lID09PSBcIi9cIlxuICApIHtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLm5leHQoKTtcbiAgfVxuXG4gIC8vIDEpIENPUlMgcHJlZmxpZ2h0IOKAlCBIQVIgRE9JTSBv4oCYdGthemFtaXogKGFrcyBob2xkYSAzMDcvQ09SUyB4YXRvc2kgYm/igJhsYWRpKVxuICBpZiAocmVxLm1ldGhvZCA9PT0gXCJPUFRJT05TXCIpIHtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLm5leHQoKTtcbiAgfVxuXG4gIC8vIDIpIFB1YmxpYyBBUEnigJlsYXIg4oCUIG1pZGRsZXdhcmXigJlkYW4gb+KAmHRrYXppYiB5dWJvcmFtaXpcbiAgaWYgKFBVQkxJQ19BUElfUFJFRklYRVMuc29tZSgocCkgPT4gcGF0aG5hbWUuc3RhcnRzV2l0aChwKSkpIHtcbiAgICByZXR1cm4gTmV4dFJlc3BvbnNlLm5leHQoKTtcbiAgfVxuXG4gIGNvbnN0IGlzTG9naW5QYWdlID0gcGF0aG5hbWUgPT09IFwiL2xvZ2luXCI7XG4gIGNvbnN0IGF1dGhlZCA9IGhhc0F1dGhDb29raWUocmVxLmhlYWRlcnMuZ2V0KFwiY29va2llXCIpKTtcblxuICAvLyAzKSBMb2dpbiBzYWhpZmFzaWdhIGtlbHNhIHZhIGFsbGFxYWNob24gbG9naW4gYm/igJhsc2EgLT4gL3N0YXRpc3RpY3NcbiAgaWYgKGlzTG9naW5QYWdlICYmIGF1dGhlZCkge1xuICAgIGNvbnN0IHVybCA9IHJlcS5uZXh0VXJsLmNsb25lKCk7XG4gICAgdXJsLnBhdGhuYW1lID0gXCIvc3RhdGlzdGljc1wiO1xuICAgIHJldHVybiBOZXh0UmVzcG9uc2UucmVkaXJlY3QodXJsKTtcbiAgfVxuXG4gIC8vIDQpIEhpbW95YWxhbmdhbiBVSSBzYWhpZmFsYXJcbiAgY29uc3QgbmVlZHNBdXRoUGFnZSA9IFBST1RFQ1RFRF9QQUdFX1BSRUZJWEVTLnNvbWUoKHApID0+XG4gICAgcGF0aG5hbWUuc3RhcnRzV2l0aChwKVxuICApO1xuXG4gIC8vIDUpIEhpbW95YWxhbmdhbiBBUEk6IC9hcGkvKiogbGVraW4gUFVCTElDX0FQSV9QUkVGSVhFUyB0YXJraWJpZ2Ega2lybWFnYW5sYXJpXG4gIGNvbnN0IGlzQXBpID0gcGF0aG5hbWUuc3RhcnRzV2l0aChcIi9hcGlcIik7XG4gIGNvbnN0IGlzUHJvdGVjdGVkQXBpID1cbiAgICBpc0FwaSAmJiAhUFVCTElDX0FQSV9QUkVGSVhFUy5zb21lKChwKSA9PiBwYXRobmFtZS5zdGFydHNXaXRoKHApKTtcblxuICBpZiAoKG5lZWRzQXV0aFBhZ2UgfHwgaXNQcm90ZWN0ZWRBcGkpICYmICFhdXRoZWQpIHtcbiAgICBjb25zdCB1cmwgPSByZXEubmV4dFVybC5jbG9uZSgpO1xuICAgIHVybC5wYXRobmFtZSA9IFwiL2xvZ2luXCI7XG4gICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJuZXh0XCIsIHBhdGhuYW1lICsgKHNlYXJjaCB8fCBcIlwiKSk7XG4gICAgcmV0dXJuIE5leHRSZXNwb25zZS5yZWRpcmVjdCh1cmwpO1xuICB9XG5cbiAgcmV0dXJuIE5leHRSZXNwb25zZS5uZXh0KCk7XG59XG5cbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XG4gIG1hdGNoZXI6IFtcIi8oKD8hX25leHQvc3RhdGljfF9uZXh0L2ltYWdlfGZhdmljb24uaWNvfGljb25zL3xpbWcvKS4qKVwiXSxcbn07Il0sIm5hbWVzIjpbIk5leHRSZXNwb25zZSIsImhhc0F1dGhDb29raWUiLCJQVUJMSUNfQVBJX1BSRUZJWEVTIiwiUFJPVEVDVEVEX1BBR0VfUFJFRklYRVMiLCJtaWRkbGV3YXJlIiwicmVxIiwicGF0aG5hbWUiLCJzZWFyY2giLCJuZXh0VXJsIiwic3RhcnRzV2l0aCIsIm5leHQiLCJtZXRob2QiLCJzb21lIiwicCIsImlzTG9naW5QYWdlIiwiYXV0aGVkIiwiaGVhZGVycyIsImdldCIsInVybCIsImNsb25lIiwicmVkaXJlY3QiLCJuZWVkc0F1dGhQYWdlIiwiaXNBcGkiLCJpc1Byb3RlY3RlZEFwaSIsInNlYXJjaFBhcmFtcyIsInNldCIsImNvbmZpZyIsIm1hdGNoZXIiXSwiaWdub3JlTGlzdCI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(middleware)/./middleware.ts\n");

/***/ })

});